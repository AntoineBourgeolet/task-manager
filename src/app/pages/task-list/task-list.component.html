<div class="kanban">
  @for (col of columns; track col.id) {
  <section class="column">
    <header class="header">
      <h3>{{ col.title }} </h3>
      <span>Nombre de tickets : {{ tasks[col.id].length}}</span>
    </header>

    <div class="list" cdkDropList [id]="col.id" [cdkDropListData]="tasks[col.id]"
      [cdkDropListConnectedTo]="getConnectedLists()" (cdkDropListDropped)="drop($event,col.id)">
      @for (task of tasks[col.id]; track task.id) {
      <div class="card" cdkDrag>
        <mat-card appearance="outlined">
          <mat-card-header>
            <mat-card-title>Id : {{ task.id }}</mat-card-title>
            <mat-card-subtitle>{{ task.title}} </mat-card-subtitle>
          </mat-card-header>
          <mat-card-content>
            <mat-form-field>
              <mat-label>Utilisateur affecté</mat-label>
              <mat-select matNativeControl [(value)]="task.userAffectee" (valueChange)="affecteUser(task.id, $event)">
                <mat-option></mat-option>
                @for (user of users; track user.username) {
                <mat-option [value]="user.username">{{user.username}}</mat-option>
                }
              </mat-select>
            </mat-form-field>
          </mat-card-content>
          <mat-chip-set class="tag-chip-set" aria-label="Tag">
            @for (tag of task.tags; track tag) {
            <mat-chip class="tag-chip">
              {{ tag }}
            </mat-chip>
          }
          </mat-chip-set>
          <mat-card-actions>
            <button matButton>Supprimer définitivement.</button>
          </mat-card-actions>
        </mat-card>
      </div>
      }

      @empty {
      <div class="empty">Aucune tâche ici</div>
      }
    </div>
  </section>
  }
</div>